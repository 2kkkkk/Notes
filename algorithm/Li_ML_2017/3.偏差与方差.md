---
date: 2019-12-14 11:55
status: public
title: 3.偏差与方差
---

现在先假设随机变量**x**的均值为$\mu $，方差为$\sigma ^{2} $，现在对其均值及方差进行估计。首先采样出N个点，若以这N个点的均值$m $作为对$\mu $的估计值，由于$m $的期望值等于$\mu $，那么$m $是$\mu $的无偏估计，$m $的方差为$\frac{\sigma ^{2}}{N}$。
若以这N个点的方差$s^2 $作为对$\sigma ^{2} $的估计，由于$s^2 $的期望为$\frac{N-1}{N}\sigma ^2$不等于$\sigma ^{2} $，那么$s^2 $为$\sigma ^{2} $的有偏估计，$s^2 $的方差为。。视频里没说，可以查一下。

---
机器学习中所说的**偏差和方差是针对模型model来说的**。

[图1 偏差与方差](https://note.youdao.com/yws/public/resource/4934d638ff72da99e7441fa4e815dcb0/xmlnote/52A9D2878AFF4A8CB6A1BC05C99DF65C/1616)

上图中，位于红色靶心的$\hat{f}$表示真正要学习的函数，${f^\*}$表示模型model
**在不同数据集上（即视频中说的平行宇宙）**
训练得到的函数，${f^\*}$的期望即模型model的偏差，表示其与真正函数$\hat{f}$（即靶心）的偏差程度。，${f^*}$ 的离散程度即模型model的方差。

**通俗地来说，如果以击中靶心为最终目标的话，模型的偏差指的是在瞄准靶心时瞄的准不准，模型的方差指的是在瞄准之后射的准不准（射的位置和瞄的位置的偏离有多大）**

---

为什么模型model越简单，方差越小？
考虑极端的情况，model（function set）中只有一个函数${f^\*}=c$，那么不管数据集如何改变（位于哪个平行宇宙）,模型始终会输出同一个函数${f^*}=c$，即0方差。

[图2](https://note.youdao.com/yws/public/resource/4934d638ff72da99e7441fa4e815dcb0/xmlnote/65026C4D4E4643D99935B7724E258EA1/1617)

上图中，黑色的线表示真正的函数$\hat{f}$，红色的线表示模型model在不同数据集上学习到的${f^*}$，蓝色的线表示的是所有红色线的平均。左图中的模型只有一次项，模型简单，具有高偏差、低方差；右图中的模型有5次项，模型复杂，具有低偏差、高方差。

**通俗地来说，如果用圆圈来表示模型model的覆盖范围，那么简单模型的圆圈会较小，可能覆盖不到靶心（真正的函数$\hat{f}$），即高偏差，但是正是由于其覆盖范围小，因此其在不同数据集上训练得到的${f^\*}$也会相对集中，即低方差；那么复杂模型的圆圈会较大，很可能会覆盖到靶心，即低偏差，但是正是由于其覆盖范围大，其在不同数据集上训练得到的${f^\*}$也会相对分散，即高方差。**

**对于复杂模型来说，由于其训练得到的${f^\*}$都不一样，但是都是位于靶心附近的（低偏差），因此如果在足够多的数据集上训练出足够多的${f^\*}$，最后取这些${f^\*}$的平均即为“靶心”**。

**对于神经网络来说，由于DNN模型复杂度高，因此所需的数据集很大，也容易过拟合。**

---

如果model偏差大，那么需要提更多的feature，或者换更复杂的model。如果model方差大，那么需要增加data(可以人工制造data)，或者加正则项，降低model复杂度。

模型选择（model selection），注意这里是**模型**选择，可以通过交叉验证进行，以树模型为例，其实也就是对树深度等超参数进行选择，这里的**超参数相当于模型**。

---

**在看这个视频之前，我对高方差的理解是：假设现在有数据集D1，在D1上训练得到了函数${f_1^\*}$，那么${f_1^\*}$会在另一个数据集D2上表现很差。看完这个视频之后，发现我这样理解确实是正确的（因为高方差本身就是说模型在不同的数据集上训练得到的${f^\*}$很不一样，也就是说在D1上表现很好的${f_1^\*}$和在D2上表现很好的${f_2^\*}$会很不一样，即${f_1^\*}$会在另一个数据集D2上表现很差），但还是不够深入。**

**还有就是，其实高方差模型并不是不好（DNN不就是很复杂的模型嘛），因为其bias很低，因此只要搞到足够的data，最后取平均，那么就会逼近真实的函数。但是在现实中，由于数据量有限，因此还是不会让模型复杂度太高，尤其是打比赛的时候。**