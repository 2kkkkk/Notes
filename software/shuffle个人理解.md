---
date: 2019-12-14 14:16
status: public
title: shuffle个人理解
---

shuffle的意思是洗牌，那就从洗牌的角度理解shuffle的过程：
假设有一大坨（比如好几十盘）打乱顺序的扑克牌，现在需要对这坨扑克牌进行操作（比如排序）。由于扑克牌太多，所以我找来了A B C D E F G 7个人来帮我洗牌。
首先将扑克牌平均分为7份发到7个人手中，（扑克牌相当于数据，7个人相当于7个分区，这7个分区可以分布在不同的worker上。即这一大坨扑克牌相当于一个RDD，这个RDD现在有7个分区）。
现在我想将这坨扑克牌按4种花色分组，那么就需要让这7个人分别将他们手中的扑克牌按4种花色进行分组，然后，对每种花色，收集来自7个人的扑克牌，分好的结果为4组，每组对应一种花色。那么，这4组花色的扑克牌就是一个新的RDD，这个RDD有4个分区，每个分区即为一个花色。而之前所有7个人手中的扑克牌即为这个新RDD的父RDD。在这个例子中，在由父RDD到子RDD的过程即涉及到shuffle，因为这个例子涉及到了数据在网络之间传输（每个人都需要将各自的结果交给“我”，然后我再进行分组）

而如果我现在想让这7个人把各自手中的每一张扑克牌的花色都更换为剩余3种的任意一种，更换后的所有扑克牌就是一个新的RDD，这个新的RDD仍然有7个分区。在这个例子中，在由父RDD到子RDD的过程不会触发shuffle操作，因为这个例子不需要“我”来参与，只需要每个人（分区）将自己手中的牌（数据）进行操作即可。
